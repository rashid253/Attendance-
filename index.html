<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Multi-School Attendance Mgmt</title>

  <!-- idb-keyval -->
  <script src="https://cdn.jsdelivr.net/npm/idb-keyval@3/dist/idb-keyval-iife.min.js"></script>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <!-- jsPDF & AutoTable -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Your styles -->
  <link rel="stylesheet" href="style.css" />

  <style>
    @media print { .no-print { display: none !important; } }
    .hidden { display: none; }
    .btn { margin: .5em; padding: .5em 1em; border: none; background: #007bff; color: #fff; border-radius: 4px; cursor: pointer; }
    .btn:hover { background: #0056b3; }
    header { display: flex; justify-content: space-between; align-items: center; padding: 1em; background: #f8f9fa; }
    .row-inline > * { margin-right: .5em; }
    section { margin: 1em; padding: 1em; border: 1px solid #ddd; border-radius: 6px; background: #fff; }
    h2 { margin-top: 0; }
  </style>
</head>
<body>
  <header>
    <h1><i class="fas fa-school"></i> Attendance Mgmt</h1>
    <div id="authActions" class="no-print hidden">
      <button id="backupBtn" class="btn"><i class="fas fa-download"></i> Backup</button>
      <button id="restoreBtn" class="btn"><i class="fas fa-upload"></i> Restore</button>
      <button id="logoutBtn" class="btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
      <input type="file" id="restoreFile" accept=".json" class="hidden"/>
    </div>
  </header>

  <!-- LOGIN -->
  <section id="loginSection">
    <h2><i class="fas fa-sign-in-alt"></i> Login</h2>
    <div class="row-inline">
      <input id="loginSchool" placeholder="School Name" />
      <select id="loginClass">
        <option disabled selected>-- Class --</option>
        <option>Play Group</option><option>Nursery</option><option>KG</option>
        <option>Class One</option><option>Class Two</option><option>Class Three</option>
        <option>Class Four</option><option>Class Five</option><option>Class Six</option>
        <option>Class Seven</option><option>Class Eight</option><option>Class Nine</option>
        <option>Class Ten</option>
      </select>
      <select id="loginSectionSelect">
        <option disabled selected>-- Section --</option>
        <option>A</option><option>B</option><option>C</option>
      </select>
      <button id="loginBtn" class="btn"><i class="fas fa-sign-in-alt"></i> Login</button>
    </div>
  </section>

  <!-- SETUP (moved outside #app) -->
  <section id="setupForm">
    <h2><i class="fas fa-cog"></i> Setup</h2>
    <div class="row-inline">
      <input id="schoolNameInput" placeholder="School Name" />
      <select id="teacherClassSelect">
        <option disabled selected>-- Class --</option>
        <option>Play Group</option><option>Nursery</option><option>KG</option>
        <option>Class One</option><option>Class Two</option><option>Class Three</option>
        <option>Class Four</option><option>Class Five</option><option>Class Six</option>
        <option>Class Seven</option><option>Class Eight</option><option>Class Nine</option>
        <option>Class Ten</option>
      </select>
      <select id="teacherSectionSelect">
        <option disabled selected>-- Section --</option>
        <option>A</option><option>B</option><option>C</option>
      </select>
      <button id="saveSetup" class="btn"><i class="fas fa-save"></i> Save</button>
    </div>
  </section>
  <section id="setupDisplay" class="hidden">
    <h3><span id="setupText"></span></h3>
    <button id="editSetup" class="btn"><i class="fas fa-edit"></i> Change</button>
  </section>

  <!-- MAIN APP (hidden until login) -->
  <div id="app" class="hidden">
    <!-- 2. Financial Settings -->
    <section id="financial-settings">
      <h2><i class="fas fa-dollar-sign"></i> Financial Settings</h2>
      <div class="row-inline">
        <input id="feeInput" placeholder="Fee Amount" type="number" />
        <button id="saveFee" class="btn"><i class="fas fa-save"></i> Save Fee</button>
      </div>
    </section>

    <!-- 3. Date Range & Counters -->
    <section id="counter-settings">
      <h2><i class="fas fa-calendar-alt"></i> Date Range & Counters</h2>
      <div class="row-inline">
        From <input id="fromDate" type="date" /> To <input id="toDate" type="date" />
        <button id="loadRange" class="btn"><i class="fas fa-sync"></i> Load</button>
      </div>
    </section>

    <!-- 4. Register Student -->
    <section id="student-register">
      <h2><i class="fas fa-user-plus"></i> Register Student</h2>
      <div class="row-inline">
        <input id="admNoInput" placeholder="Admission No" readonly />
        <input id="studentNameInput" placeholder="Student Name" />
        <button id="saveStudent" class="btn"><i class="fas fa-save"></i> Save Student</button>
      </div>
    </section>

    <!-- 5. Attendance -->
    <section id="attendance">
      <h2><i class="fas fa-check-square"></i> Attendance</h2>
      <div id="attendanceList"></div>
      <button id="saveAttendance" class="btn"><i class="fas fa-save"></i> Save Attendance</button>
    </section>

    <!-- 6. Analytics -->
    <section id="analytics">
      <h2><i class="fas fa-chart-bar"></i> Analytics</h2>
      <canvas id="attendanceChart"></canvas>
      <div class="row-inline">
        <button id="shareChart" class="btn"><i class="fas fa-share-alt"></i> Share Chart</button>
        <button id="downloadChart" class="btn"><i class="fas fa-download"></i> Download PDF</button>
      </div>
    </section>

    <!-- 7. Export / Import CSV -->
    <section id="export-import">
      <h2><i class="fas fa-file-export"></i> Export / Import</h2>
      <div class="row-inline">
        <button id="exportCsv" class="btn"><i class="fas fa-file-csv"></i> Export CSV</button>
        <button id="importCsv" class="btn"><i class="fas fa-file-upload"></i> Import CSV</button>
        <input type="file" id="csvFile" accept=".csv" class="hidden" />
      </div>
    </section>
  </div>

  <!-- Link to your JavaScript -->
  <script src="app.js"></script>
</body>
</html>

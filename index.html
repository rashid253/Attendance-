<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Attendance Management</title>

  <!-- Font Awesome -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  />
  <!-- idb-keyval -->
  <script src="https://cdn.jsdelivr.net/npm/idb-keyval@3/dist/idb-keyval-iife.min.js"></script>
  <!-- jsPDF + AutoTable -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body { font-family: sans-serif; margin: 1em; }
    section { margin-bottom: 2em; }
    .hidden { display: none; }
    .row-inline > * { margin-right: .5em; }
    .table-wrapper { overflow-x:auto; margin-top:.5em; }
    table { width:100%; border-collapse:collapse; }
    th,td { border:1px solid #ccc; padding:.3em; text-align:left; }
    .table-actions { margin-top:.5em; }
    .modal { position:fixed; inset:0; background:rgba(0,0,0,.5); display:flex; align-items:center; justify-content:center;}
    .modal-content { background:#fff; padding:1em; border-radius:4px; width:90%; max-width:320px; position:relative;}
    .modal-close { position:absolute; top:.5em; right:.5em; cursor:pointer; }
  </style>
</head>
<body>
  <h1>🏫 Attendance Management</h1>

  <!-- 1. SETUP -->
  <section id="setup-section">
    <h2>⚙️ Setup</h2>
    <div id="setupForm" class="row-inline">
      <input id="schoolNameInput" placeholder="School Name" />
      <select id="teacherClassSelect">
        <option disabled selected>-- Class --</option>
        <option>Play Group</option><option>Nursary</option><option>KG</option>
        <option>Class One</option><option>Class Two</option><option>Class Three</option>
        <option>Class Four</option><option>Class Five</option><option>Class Six</option>
        <option>Class Seven</option><option>Class Eight</option><option>Class Nine</option>
        <option>Class Ten</option>
      </select>
      <select id="teacherSectionSelect">
        <option disabled selected>-- Section --</option>
        <option>A</option><option>B</option><option>C</option>
      </select>
      <button id="saveSetup" class="no-print">Save</button>
    </div>
    <div id="setupDisplay" class="hidden">
      <strong id="setupText"></strong>
      <button id="editSetup">Edit</button>
    </div>
  </section>

  <!-- 2. FINANCIAL SETTINGS -->
  <section id="financial-settings">
    <h2>💰 Fines & Eligibility</h2>
    <div id="financialForm" class="row-inline">
      <label>Absent:<input id="fineAbsent" type="number" /></label>
      <label>Late:<input id="fineLate" type="number" /></label>
      <label>Leave:<input id="fineLeave" type="number" /></label>
      <label>HD:<input id="fineHalfDay" type="number" /></label>
      <label>% Present:<input id="eligibilityPct" type="number" min="0" max="100" /></label>
      <button id="saveSettings">Save</button>
    </div>
    <div id="settingsCard" class="hidden"></div>
    <button id="editSettings" class="hidden">Edit Settings</button>
  </section>

  <!-- 3. COUNTERS -->
  <section id="counters">
    <h2>📊 Counts</h2>
    <div class="row-inline">
      <div>Section: <span id="sectionCount">0</span></div>
      <div>Class: <span id="classCount">0</span></div>
      <div>School: <span id="schoolCount">0</span></div>
    </div>
  </section>

  <!-- 4. STUDENT REGISTRATION -->
  <section id="student-registration">
    <h2>🎓 Student Registration</h2>
    <div id="stuForm" class="row-inline">
      <input id="stuName" placeholder="Name" />
      <input id="stuParent" placeholder="Parent" />
      <input id="stuContact" placeholder="Contact" />
      <input id="stuOcc" placeholder="Occupation" />
      <input id="stuAddr" placeholder="Address" />
      <button id="addStudentBtn">Add</button>
    </div>
    <div class="table-wrapper">
      <table>
        <thead><tr>
          <th><input type="checkbox" id="selectAllStudents" /></th>
          <th>#</th><th>Adm#</th><th>Name</th><th>Parent</th>
          <th>Contact</th><th>Occupation</th><th>Address</th>
          <th>Fine</th><th>Status</th><th>Actions</th>
        </tr></thead>
        <tbody id="studentsBody"></tbody>
      </table>
    </div>
    <div class="table-actions">
      <button id="editSelected" disabled>Edit</button>
      <button id="deleteSelected" disabled>Delete</button>
    </div>
  </section>

  <!-- 5. MARK ATTENDANCE -->
  <section id="attendance-section">
    <h2>✅ Mark Attendance</h2>
    <div class="row-inline">
      <input type="date" id="dateInput" />
      <button id="loadAttendance">Load</button>
    </div>
    <div class="table-wrapper" id="attendanceBody"></div>
    <div class="table-actions">
      <button id="saveAttendance" class="hidden">Save</button>
      <button id="resetAttendance" class="hidden">Reset</button>
      <button id="downloadAttendancePDF" class="hidden">Download</button>
      <button id="shareAttendanceSummary" class="hidden">Share</button>
    </div>
  </section>

  <!-- 6. ATTENDANCE REGISTER -->
  <section id="register-section">
    <h2>📒 Attendance Register</h2>
    <div class="row-inline">
      <input type="month" id="registerMonth" />
      <button id="loadRegister">Load</button>
    </div>
    <div class="table-wrapper hidden" id="registerTableWrapper">
      <table>
        <thead><tr id="headerRow"></tr></thead>
        <tbody id="bodyTbody"></tbody>
      </table>
    </div>
    <div class="table-actions">
      <button id="changeRegister" class="hidden">Reset</button>
      <button id="saveRegister" class="hidden">Save</button>
      <button id="downloadRegister">Download</button>
      <button id="shareRegister" class="hidden">Share</button>
    </div>
  </section>

  <!-- 7. ANALYTICS -->
  <section id="analytics-section">
    <h2>📈 Analytics</h2>
    <div class="row-inline">
      <button id="downloadAnalytics">Download Report</button>
      <button id="shareAnalytics">Share Report</button>
    </div>
  </section>

  <!-- PAYMENT MODAL -->
  <div id="paymentModal" class="modal hidden">
    <div class="modal-content">
      <span id="paymentModalClose" class="modal-close">×</span>
      <h3>Payment for Adm# <span id="payAdm"></span></h3>
      <input id="paymentAmount" type="number" placeholder="Amount" />
      <div class="row-inline">
        <button id="savePayment">Save</button>
        <button id="cancelPayment">Cancel</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>

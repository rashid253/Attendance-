=== index.html ===
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Classwise Attendance Management</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header><h1>Attendance Management</h1></header>

  <!-- 1. Setup -->
  <section id="teacher-setup">
    <h2>Setup</h2>
    <div id="setupForm" class="row-inline">
      <input id="schoolNameInput" placeholder="School Name">
      <select id="teacherClassSelect">
        <option value="">--Class--</option>
        <option>Pre-Play</option><option>Pre-Prep</option><option>Nursery</option><option>Pre-One</option>
        <option>One</option><option>Two</option><option>Three</option><option>Four</option><option>Five</option>
        <option>Six</option><option>Seven</option><option>Eight</option><option>Nine</option><option>Ten</option>
      </select>
      <select id="teacherSectionSelect">
        <option value="">--Section--</option><option>A</option><option>B</option><option>C</option>
      </select>
      <button type="button" id="saveSetup">Save</button>
    </div>
    <div id="setupDisplay" class="hidden">
      <h3 id="setupText"></h3>
      <button type="button" id="editSetup" class="small">Edit</button>
    </div>
  </section>

  <!-- 2. Student Registration -->
  <section id="student-registration">
    <h2>Student Registration</h2>
    <div id="regForm" class="row-inline">
      <input id="studentName" placeholder="Name" required>
      <input id="admissionNo" placeholder="Adm#" required>
      <input id="parentName" placeholder="Parent Name" required>
      <input id="parentContact" placeholder="Parent Contact" required>
      <input id="parentOccupation" placeholder="Occupation" required>
      <input id="parentAddress" placeholder="Address" required>
      <button type="button" id="addStudent">Add</button>
    </div>
    <div class="table-wrapper" id="studentTableWrapper">
      <table id="studentTable">
        <thead>
          <tr>
            <th class="select-col"><input type="checkbox" id="selectAllStudents"></th>
            <th>Name</th><th>Adm#</th><th>Parent</th><th>Contact</th><th>Occupation</th><th>Address</th><th>Share</th>
          </tr>
        </thead>
        <tbody id="studentsBody"></tbody>
      </table>
    </div>
    <div class="table-actions">
      <button type="button" id="editSelected" disabled>Edit Selected</button>
      <button type="button" id="deleteSelected" disabled>Delete Selected</button>
      <button type="button" id="saveRegistration" class="save">Save Table</button>
      <button type="button" id="shareRegistration" class="hidden">Share Table</button>
      <button type="button" id="editRegistration" class="hidden">Edit Table</button>
      <button type="button" id="downloadRegistrationPDF" class="hidden">Download PDF</button>
      <button type="button" id="downloadRegistrationJSON">Download Registration JSON</button>
    </div>
  </section>

  <!-- 3. Attendance Marking -->
  <section id="attendance-section">
    <h2>Mark Attendance</h2>
    <div class="row-inline">
      <label for="dateInput">Select Date:</label>
      <input type="date" id="dateInput">
      <button type="button" id="loadAttendance">Load Attendance</button>
    </div>
    <div id="attendanceList"></div>
    <button type="button" id="saveAttendance" class="hidden">Save</button>
    <button type="button" id="downloadAttendanceJSON" class="hidden">Download Attendance JSON</button>
  </section>

  <!-- 4. Attendance Summary -->
  <section id="attendance-result" class="hidden">
    <h2>Attendance Summary</h2>
    <div class="table-wrapper">
      <table id="attendanceSummaryTable">
        <thead><tr><th>Name</th><th>Status</th><th>Send</th></tr></thead>
        <tbody id="summaryBody"></tbody>
      </table>
    </div>
    <div class="table-actions">
      <button type="button" id="shareAttendanceSummary">Share Table</button>
      <button type="button" id="downloadAttendancePDF">Download PDF</button>
      <button type="button" id="resetAttendance" class="small">Reset</button>
    </div>
  </section>

  <!-- 5. Analytics -->
  <section id="analytics-section">
    <h2>Analytics</h2>
    <div class="row-inline">
      <label for="analyticsTarget">Report For:</label>
      <select id="analyticsTarget">
        <option value="class">Full Class</option>
        <option value="student">Individual Student</option>
      </select>
      <input type="text" id="studentAdmInput" placeholder="Admission #" class="hidden">
      <label for="analyticsType">Period:</label>
      <select id="analyticsType">
        <option value="" disabled selected>--Select Period--</option>
        <option value="date">Specific Date</option>
        <option value="month">Month</option>
        <option value="semester">Semester</option>
        <option value="year">Year</option>
      </select>
      <input type="date" id="analyticsDate" class="hidden">
      <input type="month" id="analyticsMonth" class="hidden">
      <input type="month" id="semesterStart" class="hidden">
      <input type="month" id="semesterEnd" class="hidden">
      <input type="number" id="yearStart" class="hidden" placeholder="Year">
      <button type="button" id="loadAnalytics">Load Analytics</button>
      <button type="button" id="resetAnalytics" class="small hidden">Change</button>
    </div>
    <div id="instructions" class="summary-block hidden"></div>
    <div id="analyticsContainer" class="table-container hidden"></div>
    <div id="graphs" class="graph-container hidden">
      <canvas id="barChart"></canvas>
      <canvas id="pieChart"></canvas>
    </div>
    <div id="analyticsActions" class="row-inline hidden">
      <button type="button" id="shareAnalytics">Share as Text</button>
      <button type="button" id="downloadAnalytics">Download Analytics PDF</button>
    </div>
  </section>

  <!-- 6. Attendance Register -->
  <section id="register-section">
    <h2>Attendance Register</h2>
    <div class="row-inline">
      <label for="registerMonth">Select Month:</label>
      <input type="month" id="registerMonth">
      <button type="button" id="loadRegister" class="save">Load Register</button>
      <button type="button" id="changeRegister" class="small hidden">Change Period</button>
    </div>
    <div class="table-wrapper hidden" id="registerTableWrapper">
      <table id="registerTable">
        <thead>
          <tr>
            <th>Sr#</th><th>Adm#</th><th>Name</th>
          </tr>
        </thead>
        <tbody id="registerBody"></tbody>
      </table>
    </div>
    <div id="registerSummarySection" class="hidden">
      <h3>Summary</h3>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr><th>Name</th><th>P</th><th>A</th><th>Lt</th><th>HD</th><th>L</th><th>%</th></tr>
          </thead>
          <tbody id="registerSummaryBody"></tbody>
        </table>
      </div>
    </div>
    <div class="table-actions">
      <button type="button" id="shareRegister" class="save">Share Summary</button>
      <button type="button" id="downloadRegisterPDF" class="save">Download PDF</button>
    </div>
  </section>

  <!-- Libraries + Single Script -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <script src="app.js"></script>
</body>
</html>

=== style.css ===
/* basic reset */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* utility */
.hidden { display: none !important; }
.row-inline { display: flex; gap: 0.5em; flex-wrap: wrap; margin-bottom: 1em; }
.small { font-size: 0.8em; padding: 0.2em 0.5em; }

/* header */
header { background: #004d99; color: #fff; padding: 1em; text-align: center; }

/* sections */
section { padding: 1em; border-bottom: 1px solid #ddd; }
h2 { margin-bottom: 0.5em; color: #004d99; }

/* inputs & selects */
input, select, button {
  padding: 0.5em;
  font-size: 1em;
  border: 1px solid #ccc;
  border-radius: 4px;
}
input:focus, select:focus { outline: 2px solid #004d99; }

/* buttons */
button {
  background: #0066cc;
  color: #fff;
  border: none;
  cursor: pointer;
  border-radius: 4px;
}
button:hover { background: #005bb5; }
button:disabled { background: #aaa; cursor: not-allowed; }

/* table wrapper */
.table-wrapper { overflow-x: auto; margin-bottom: 1em; }
table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 1em;
}
th, td {
  border: 1px solid #ccc;
  padding: 0.5em;
  text-align: left;
}
th { background: #f0f0f0; }

/* selection highlight */
tr.selected { background: #e6f7ff; }

/* attendance buttons */
.attendance-actions { display: inline-flex; gap: 0.25em; margin-bottom: 0.5em; }
.att-btn {
  width: 2em; height: 2em;
  border-radius: 4px;
  border: 1px solid #999;
  background: #fff;
  cursor: pointer;
}
.att-btn:hover { border-color: #333; }

/* JSON-download buttons */
#downloadRegistrationJSON,
#downloadAttendanceJSON {
  background: #28a745;
  color: #fff;
  border: none;
  padding: 0.5em 1em;
  border-radius: 4px;
  cursor: pointer;
  margin-left: 0.5em;
}
#downloadRegistrationJSON:hover,
#downloadAttendanceJSON:hover {
  background: #218838;
}

/* analytics charts */
.graph-container { display: flex; gap: 1em; flex-wrap: wrap; margin: 1em 0; }
canvas { max-width: 100%; }

/* PDF download buttons */
.save { background: #17a2b8; }
.save:hover { background: #138496; }

=== app.js ===
window.addEventListener('DOMContentLoaded', () => {
  const $ = id => document.getElementById(id);
  const colors = { P: '#4CAF50', A: '#f44336', Lt: '#FFEB3B', HD: '#FF9800', L: '#03a9f4' };

  // 1. SETUP
  const schoolIn = $('schoolNameInput');
  const classSel = $('teacherClassSelect');
  const secSel = $('teacherSectionSelect');
  const saveSetup = $('saveSetup');
  const setupForm = $('setupForm');
  const setupDisplay = $('setupDisplay');
  const setupText = $('setupText');
  const editSetup = $('editSetup');

  function loadSetup() {
    const school = localStorage.getItem('schoolName');
    const cls    = localStorage.getItem('teacherClass');
    const sec    = localStorage.getItem('teacherSection');
    if (school && cls && sec) {
      schoolIn.value = school;
      classSel.value = cls;
      secSel.value   = sec;
      setupText.textContent = `${school} 🏫 | Class: ${cls} | Section: ${sec}`;
      setupForm.classList.add('hidden');
      setupDisplay.classList.remove('hidden');
    }
  }

  saveSetup.onclick = e => {
    e.preventDefault();
    if (!schoolIn.value || !classSel.value || !secSel.value)
      return alert('Complete setup');
    localStorage.setItem('schoolName', schoolIn.value);
    localStorage.setItem('teacherClass', classSel.value);
    localStorage.setItem('teacherSection', secSel.value);
    loadSetup();
  };

  edit_SETUP.onclick = e => {
    e.preventDefault();
    setupForm.classList.remove('hidden');
    setupDisplay.classList.add('hidden');
  };

  loadSetup();

  // 2. STUDENT REGISTRATION
  let students = JSON.parse(localStorage.getItem('students') || '[]');
  const studentNameIn    = $('studentName');
  const admissionNoIn    = $('admissionNo');
  const parentNameIn     = $('parentName');
  const parentContactIn  = $('parentContact');
  const parentOccIn      = $('parentOccupation');
  const parentAddrIn     = $('parentAddress');
  const addStudentBtn    = $('addStudent');
  const studentsBody     = $('studentsBody');
  const selectAll        = $('selectAllStudents');
  const editSelBtn       = $('editSelected');
  const deleteSelBtn     = $('deleteSelected');
  const saveRegBtn       = $('saveRegistration');
  const shareRegBtn      = $('shareRegistration');
  const editRegBtn       = $('editRegistration');
  const downloadRegBtn   = $('downloadRegistrationPDF');
  let regSaved = false, inlineEdit = false;

  function saveStudents() {
    localStorage.setItem('students', JSON.stringify(students));
  }

  function renderStudents() {
    studentsBody.innerHTML = '';
    students.forEach((s, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML =
        `<td><input type="checkbox" class="sel" data-index="${i}" ${regSaved ? 'disabled' : ''}></td>` +
        `<td>${s.name}</td><td>${s.adm}</td><td>${s.parent}</td>` +
        `<td>${s.contact}</td><td>${s.occupation}</td><td>${s.address}</td>` +
        `<td>${regSaved ? '<button class="share-one">Share</button>' : ''}</td>`;
      if (regSaved) {
        tr.querySelector('.share-one').onclick = ev => {
          ev.preventDefault();
          const hdr = `School: ${localStorage.getItem('schoolName')}\nClass: ${localStorage.getItem('teacherClass')}\nSection: ${localStorage.getItem('teacherSection')}`;
          const msg = `${hdr}\n\nName: ${s.name}\nAdm#: ${s.adm}\nParent: ${s.parent}\nContact: ${s.contact}\nOccupation: ${s.occupation}\nAddress: ${s.address}`;
          window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`, '_blank');
        };
      }
      studentsBody.appendChild(tr);
    });
    bindSelection();
  }

  function bindSelection() {
    const boxes = Array.from(document.querySelectorAll('.sel'));
    boxes.forEach(cb => {
      cb.onchange = () => {
        cb.closest('tr').classList.toggle('selected', cb.checked);
        const any = boxes.some(x => x.checked);
        editSelBtn.disabled = deleteSelBtn.disabled = !any;
      };
    });
    selectAll.disabled = regSaved;
    selectAll.onchange = () => {
      if (!regSaved) boxes.forEach(cb => {
        cb.checked = selectAll.checked;
        cb.dispatchEvent(new Event('change'));
      });
    };
  }

  addStudentBtn.onclick = ev => {
    ev.preventDefault();
    const name    = studentNameIn.value.trim();
    const adm     = admissionNoIn.value.trim();
    const parent  = parentNameIn.value.trim();
    const contact = parentContactIn.value.trim();
    const occ     = parentOccIn.value.trim();
    const addr    = parentAddrIn.value.trim();
    if (!name || !adm || !parent || !contact || !occ || !addr)
      return alert('All fields required');
    if (!/^\d+$/.test(adm)) return alert('Adm# must be numeric');
    if (students.some(s => s.adm === adm))
      return alert(`Admission# ${adm} already exists`);
    if (!/^\d{7,15}$/.test(contact))
      return alert('Contact must be 7-15 digits');
    students.push({
      name, adm, parent, contact,
      occupation: occ, address: addr,
      roll: Date.now()
    });
    saveStudents();
    renderStudents();
    [studentNameIn, admissionNoIn, parentNameIn, parentContactIn, parentOccIn, parentAddrIn].forEach(i => i.value = '');
  };

  function onCellBlur(e) {
    const td = e.target, tr = td.closest('tr');
    const idx = +tr.querySelector('.sel').dataset.index;
    const ci  = Array.from(tr.children).indexOf(td);
    const keys = ['name','adm','parent','contact','occupation','address'];
    const val = td.textContent.trim();
    if (ci === 2) {
      if (!/^\d+$/.test(val)) { alert('Adm# must be numeric'); renderStudents(); return; }
      if (students.some((s,i2) => s.adm===val && i2!==idx)) {
        alert('Duplicate Adm# not allowed'); renderStudents(); return;
      }
    }
    if (ci>=1 && ci<=6) {
      students[idx][keys[ci-1]] = val;
      saveStudents();
    }
  }

  editSelBtn.onclick = ev => {
    ev.preventDefault();
    const sel = Array.from(document.querySelectorAll('.sel:checked'));n

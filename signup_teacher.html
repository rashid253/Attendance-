<!DOCTYPE html>
<html><head><title>Teacher Sign Up</title></head><body>
  <h1>Teacher Sign Up</h1>
  <select id="school"></select>
  <select id="class"></select>
  <select id="section"></select>
  <form id="form">
    <input type="email" id="email" required placeholder="Email">
    <input type="password" id="pass" required placeholder="Password">
    <button type="submit">Sign Up</button>
  </form>
  <script type="module">
    import { db } from './app.js';
    import { signup } from './auth.js';
    import { collection, getDocs, where, query } from 'firebase/firestore';

    // Load approved schools
    (async()=>{
      const q = query(collection(db,'schools'), where('status','==','approved'));
      (await getDocs(q)).forEach(doc=>{
        const s=doc.data();
        school.add(new Option(s.name,s.id));
      });
    })();

    document.getElementById('form').addEventListener('submit', async e=>{
      e.preventDefault();
      const extra = { schoolId: school.value, class: class.value, section: section.value };
      try{
        await signup(e.target.email.value, e.target.pass.value, 'teacher', extra);
        alert('Signed up! Wait for admin approval.');
        location='login.html';
      }catch(err){alert(err.message);}
    });
  </script>
</body></html>
